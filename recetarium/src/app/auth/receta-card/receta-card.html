<div class="receta-card">
  
  <!-- INTRO -->
  <div class="introduccion" (click)="toggleDetalles()">
    <div class="imagen-container" *ngIf="receta.imagen">
      <img [src]="receta.imagen" class="imagen-banner" />
    </div>

    <div class="texto">
      <span class="badge"
        [ngClass]="{
          'vegana': receta.es_vegana == 1,
          'vegetariana': receta.es_vegetariana == 1 && receta.es_vegana == 0,
          'normal': receta.es_vegana == 0 && receta.es_vegetariana == 0
        }">
        {{
          receta.es_vegana ? 'Vegana ğŸŒ±' :
          receta.es_vegetariana ? 'Vegetariana ğŸ¥—' :
          'Normal ğŸ–'
        }}
      </span>

      <h2>{{ receta.titulo }}</h2>
      <p class="categoria">{{ receta.categoria }}</p>
      <p class="descripcion">{{ receta.descripcion }}</p>
    </div>

    <div class="toggle-area">
      <span class="flecha" [class.rotar]="abierta">â–¼</span>
    </div>
  </div>

  <!-- DETALLES + COMENTARIOS LADO DERECHO -->
  <div class="detalles" [class.abierto]="abierta">

    <div *ngIf="detalles && abierta" class="detalle-wrapper">

      <!-- COLUMNA IZQUIERDA (tus detalles normales) -->
      <div class="col-detalles">
        
        <p><strong>â± Tiempo:</strong> {{ receta.tiempo_preparacion }} min</p>
        <p><strong>ğŸ½ Porciones:</strong> {{ receta.porciones }}</p>
        <p><strong>ğŸ”¥ Dificultad:</strong> {{ receta.dificultad }}</p>

        <h4>ğŸ§‚ Ingredientes:</h4>
        <ul>
          <li *ngFor="let ing of detalles.ingredientes">
            {{ ing.nombre }} â€” {{ ing.cantidad }} {{ ing.unidad }}
          </li>
        </ul>

        <h4>ğŸ‘¨â€ğŸ³ Pasos:</h4>
        <ol>
          <li *ngFor="let paso of detalles.pasos">
            {{ paso.numero_paso }}. {{ paso.descripcion }}
          </li>
        </ol>
      </div>

      <!-- COLUMNA DERECHA (comentarios + likes) -->
      <div class="col-social">
<button class="btn-agregar" (click)="agregarAMisRecetas()">
  â• Agregar a mis recetas
</button>

        <div class="likes-box">
          <button class="like-btn" 
                  [class.liked]="liked"
                  (click)="toggleLike()">
            â¤ï¸ {{ likes }}
          </button>
        </div>

        <h4>ğŸ’¬ Comentarios</h4>

        <div class="comentario" *ngFor="let c of comentarios">
          <p class="autor">
            <strong>{{ c.nombre || 'Usuario' }}</strong>
          </p>
          <p>{{ c.comentario }}</p>
          <small>{{ c.fecha | date:'short' }}</small>
        </div>

        <textarea [(ngModel)]="nuevoComentario"
                  placeholder="Escribe un comentario..."></textarea>

        <button class="btn-enviar" (click)="enviarComentario()">
          Publicar
        </button>

      </div>

    </div>
  </div>

</div>
